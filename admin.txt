<?php
session_start();
include "db.php";

// akun admin
$admin_user = "admin";
$admin_pass = "12345";

if(isset($_POST['username'], $_POST['password'])){
    if($_POST['username'] === $admin_user && $_POST['password'] === $admin_pass){
        $_SESSION['login'] = true;
    } else {
        echo "<p style='color:red'>Login gagal!</p>";
    }
}

if(isset($_GET['logout'])){
    session_destroy();
    header("Location: admin.php");
    exit;
}

if(!isset($_SESSION['login'])){
?>
<!DOCTYPE html>
<html>
<head><title>Login Admin</title></head>
<body>
  <h2>Login Admin</h2>
  <form method="post">
    <input type="text" name="username" placeholder="Username" required><br><br>
    <input type="password" name="password" placeholder="Password" required><br><br>
    <button type="submit">Login</button>
  </form>
</body>
</html>
<?php
exit;
}
?>

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Data Reservasi</title>
</head>
<body>
  <h2>ðŸ“‹ Daftar Reservasi</h2>
  <a href="admin.php?logout=1">Logout</a><br><br>
  <table border="1" cellpadding="6">
    <tr><th>ID</th><th>Waktu</th><th>Nama</th><th>Pesan</th><th>Kehadiran</th></tr>
    <?php
    $result = $conn->query("SELECT * FROM reservasi ORDER BY waktu DESC");
    while($row = $result->fetch_assoc()){
        echo "<tr>
                <td>{$row['id']}</td>
                <td>{$row['waktu']}</td>
                <td>".htmlspecialchars($row['nama'])."</td>
                <td>".htmlspecialchars($row['pesan'])."</td>
                <td>{$row['attendance']}</td>
              </tr>";
    }
    ?>
  </table>
</body>
</html>